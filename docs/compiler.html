
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Blaze Compiler Infrastructure &mdash; Blaze 0.1-dev documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-2.2.1.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-responsive-2.2.1.min.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/bootstrap-2.2.1.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="_static/js/bootstrap-scrollspy.js"></script>
    <script type="text/javascript" src="_static/js/bootstrap-affix.js"></script>
    <link rel="top" title="Blaze 0.1-dev documentation" href="index.html" />
    <link rel="next" title="Datashape" href="datashape.html" />
    <link rel="prev" title="Memory Layout" href="memory.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

<div class="container">
  <!-- This is copied from /web, find better solution -->
  <div class="masthead">
    <ul class="nav nav-pills pull-right">
        <li>
            <a href="/index.html"><i class="icon-home"></i> Blaze</a>
        </li>
        
        <li class="active">
            <a href="/docs/index.html"><i class="icon-book"></i> Documentation</a>
        </li>
        
        <li>
            <a href="/examples.html"><i class="icon-ok"></i> Examples</a>
        </li>
        
        <li>
            <a href="http://github.com/ContinuumIO/blaze-core"><i class="icon-download"></i> Source</a>
        </li>
        
        <li>
            <a href="/vision.html"><i class="icon-star"></i> Vision</a>
        </li>
        
        <li>
            <a href="/people.html"><i class="icon-user"></i> People</a>
        </li>
        
        <li>
            <a href="http://groups.google.com/a/continuum.io/forum/#!forum/blaze-dev"><i class="icon-envelope"></i> Mailing List</a>
        </li>
    </ul>
    <h3 class="muted"><img src="_static/img/logo.png">Blaze</h3>
  </div>

  <hr>

  <div class="row">
      <div class="span3">
         <ul id="nav" class="nav nav-list" data-spy="affix" data-offset-top="200"><li><a href="index.html"><b>Index</b></a></li>
<ul>
<li><a class="reference internal" href="#">Blaze Compiler Infrastructure</a><ul>
<li><a class="reference internal" href="#goals">Goals</a></li>
<li><a class="reference internal" href="#example-syntax">Example Syntax</a></li>
<li><a class="reference internal" href="#prelude">Prelude</a></li>
<li><a class="reference internal" href="#external-libraries">External Libraries</a></li>
<li><a class="reference internal" href="#pipeline">Pipeline</a></li>
<li><a class="reference internal" href="#opcodes">Opcodes</a></li>
</ul>
</li>
</ul>

         </ul>
      </div>
      <div class="span9">
          
  <div class="section" id="blaze-compiler-infrastructure">
<h1>Blaze Compiler Infrastructure<a class="headerlink" href="#blaze-compiler-infrastructure" title="Permalink to this headline">¶</a></h1>
<p>Blir is the Blaze intermediate representation. It aims to be a simple
statically typed C/Python like language that can be programmatically
generated from Python itself to generate kernels and executed over Blaze
and NumPy structures without going through Python AST as intermediate
pass.</p>
<p>The goal is not general purpose programming but to generate a a simple
compiler target that is human readable and amenable to array computing
and kernel generation while still being flexible. Blir is more or less
inspired by the <a class="reference external" href="http://www.cminusminus.org/">C&#8211; intermediate language</a>.</p>
<p>Right now BLIR is fairly naive, it does not do a lot of common
optimizations ( strength reduction, loop invariant code motion, common
subexpression elimination ). The goal is simply to create a programmatic
interface for generating kernels and (maybe) make it efficient.</p>
<div class="section" id="goals">
<h2>Goals<a class="headerlink" href="#goals" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>A <em>small</em> portable language with C like syntax</li>
<li>Ability to dynamically generate much of what exists in the NumPy
<tt class="docutils literal"><span class="pre">umath.h</span></tt> library on demand specialized to any Blaze data type.</li>
<li>An interface between high-level expressions and retargetable optimizing code generators</li>
<li>Phasing out NumPy memory blocks in favor of
supporting computation over BLZ and out-of-core data described
over the Blaze protocol.</li>
</ul>
</div>
<div class="section" id="example-syntax">
<h2>Example Syntax<a class="headerlink" href="#example-syntax" title="Permalink to this headline">¶</a></h2>
<p>Some examples of trivial compute kernels:</p>
<div class="highlight-python"><pre>def mykernel(x : array[int]) -&gt; int {
    var int i;
    var int j;

    for i in range(5) {
        for j in range(5) {
            x[i,j] = x[i,i] + x[j,j];
        }
    }
    return 0;
}</pre>
</div>
<div class="highlight-python"><pre>def add(x : int, y : int) -&gt; int {
    return x+y;
}</pre>
</div>
<div class="highlight-python"><pre>def sumrange(x : int, y : int) -&gt; int {
    var int i;
    var int accum;

    for i in range(x, y) {
        accum = accum + i;
    }
    return accum;
}</pre>
</div>
<div class="highlight-python"><pre>def alltrue(x: array[bool]) -&gt; bool {
    var bool cond;

    for i in range(1000) {
        cond = cond &amp;&amp; x[i];
    }
    return cond;
}</pre>
</div>
</div>
<div class="section" id="prelude">
<h2>Prelude<a class="headerlink" href="#prelude" title="Permalink to this headline">¶</a></h2>
<p>The prelude is existing body of C libraries that are linked into the
generated code automatically. These will include string manipulation,
file handling and Blaze iterator protocol.</p>
</div>
<div class="section" id="external-libraries">
<h2>External Libraries<a class="headerlink" href="#external-libraries" title="Permalink to this headline">¶</a></h2>
<p>Blaze compute kernels can include external C libraries which are
specified with <tt class="docutils literal"><span class="pre">foreign</span></tt> keyword.</p>
<div class="highlight-python"><pre>foreign "C" def append(x : str, y: str) -&gt; str;</pre>
</div>
</div>
<div class="section" id="pipeline">
<h2>Pipeline<a class="headerlink" href="#pipeline" title="Permalink to this headline">¶</a></h2>
<img src="_images/pipeline.svg" /></div>
<div class="section" id="opcodes">
<h2>Opcodes<a class="headerlink" href="#opcodes" title="Permalink to this headline">¶</a></h2>
<p>Internally after CFG generation Blaze uses a set of internal opcodes to
stand for units of code generation that are then translated into LLVM
constructs. These are more or less modeled after the Python bytecode,
but with different semantics.</p>
<ul class="simple">
<li>ALLOC</li>
<li>ARRAYLOAD</li>
<li>ARRAYSTORE</li>
<li>BINARY_ADD</li>
<li>BINARY_DIVIDE</li>
<li>BINARY_MULTIPLY</li>
<li>BINARY_SUBTRACT</li>
<li>CALL_FOREIGN</li>
<li>CALL_FUNCTION</li>
<li>COMPARE</li>
<li>GLOBAL</li>
<li>LOAD</li>
<li>LOAD_ARGUMENT</li>
<li>LOAD_CONST</li>
<li>PRINT</li>
<li>RETURN</li>
<li>STORE</li>
<li>UNARY_NEGATIVE</li>
<li>UNARY_NOT</li>
<li>UNARY_POSITIVE</li>
</ul>
</div>
</div>


      </div>
  </div>
</div>
  </body>
</html>