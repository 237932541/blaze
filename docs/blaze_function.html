
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Blaze Functions &mdash; Blaze 0.3.0 documentation</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-2.2.1.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/bootstrap-responsive-2.2.1.min.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/bootstrap-2.2.1.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="_static/js/bootstrap-scrollspy.js"></script>
    <script type="text/javascript" src="_static/js/bootstrap-affix.js"></script>
    <link rel="top" title="Blaze 0.3.0 documentation" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

<div class="container">
  <!-- This is copied from /web, find better solution -->
  <div class="masthead">
    <ul class="nav nav-pills pull-right">
        <li>
            <a href="/index.html"><i class="icon-home"></i> Blaze</a>
        </li>
        
        <li class="active">
            <a href="/docs/index.html"><i class="icon-book"></i> Documentation</a>
        </li>
        
        <li>
            <a href="/examples.html"><i class="icon-ok"></i> Examples</a>
        </li>
        
        <li>
            <a href="http://github.com/ContinuumIO/blaze-core"><i class="icon-download"></i> Source</a>
        </li>
        
        <li>
            <a href="/vision.html"><i class="icon-star"></i> Vision</a>
        </li>
        
        <li>
            <a href="/people.html"><i class="icon-user"></i> People</a>
        </li>
        
        <li>
            <a href="http://groups.google.com/a/continuum.io/forum/#!forum/blaze-dev"><i class="icon-envelope"></i> Mailing List</a>
        </li>
    </ul>
    <h3 class="muted"><img src="_static/img/logo.png">Blaze</h3>
  </div>

  <hr>

  <div class="row">
      <div class="span3">
         <ul id="nav" class="nav nav-list" data-spy="affix" data-offset-top="200"><li><a href="index.html"><b>Index</b></a></li>
<ul>
<li><a class="reference internal" href="#">Blaze Functions</a><ul>
<li><a class="reference internal" href="#blaze-element-kernels">Blaze Element Kernels</a></li>
<li><a class="reference internal" href="#kerneltrees">KernelTrees</a></li>
<li><a class="reference internal" href="#lifting">Lifting</a></li>
<li><a class="reference internal" href="#broadcasting">Broadcasting</a></li>
</ul>
</li>
</ul>

         </ul>
      </div>
      <div class="span9">
          
  <div class="section" id="blaze-functions">
<h1>Blaze Functions<a class="headerlink" href="#blaze-functions" title="Permalink to this headline">¶</a></h1>
<p>Blaze Functions are the simplest calculation engine for
Blaze Arrays.   Simple operations like add, multiply, sin,
cos, comparisons, etc. are implemented with Blaze Functions.
But, also complicated operations like eigenvalue decomposition,
dot-products, and Fourier Transforms can be implemented via Blaze
Functions.  Blaze Functions are any operation that is performed
on an &#8220;element&#8221; where all the inputs and the output fit in
memory.   Blaze Functions are like ufunc objects in NumPy
with three important differences:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Kernel arguments can be vectors (like generalized ufuncs)</li>
<li>More types of data are supported (including structures)</li>
<li>Lazy evaluation &#8211; calling a ufunc builds up a graph and
machine code is generated at evaluation time.</li>
</ol>
</div></blockquote>
<p>Example:</p>
<p>Assume a and b are Blaze Arrays or objects that can be converted
to Blaze Arrays and dot, mul, and add are Blaze Functions</p>
<p>result = dot(add(a,b), mul(a,b))</p>
<p>Result will be a &#8220;deferred&#8221; Blaze Array.  The eval function
must be called to create a materialized, concrete, or
reified Blaze Array which will apply a generated kernel
based on the expression.   The kernel is composed of the kernels
selected from add, mul, and dot based on the data-shape of
the input arguments.   These low-level kernels are built up
using LLVM and compiled to machine code
(using vector-instructions where possible).
This fused, low-level kernel is applied over the data.</p>
<div class="section" id="blaze-element-kernels">
<h2>Blaze Element Kernels<a class="headerlink" href="#blaze-element-kernels" title="Permalink to this headline">¶</a></h2>
<p>A Blaze Element Kernel is an object that contains an LLVM
function with a particular signature.  This function should
perform the operation on a single element.  So, for example
an add Element Kernel would wrap around an LLVM function that
adds two typed values.   You don&#8217;t need to worry about this
being slow, the BlazeFunction compiler will create
an in-line version of the function.  The LLVM function
signature consists of the inputs followed by one output.
(Multiple outputs can be returned from an element kernel by
using a structure as the output data-type.)</p>
<p>Here is an example of an LLVM Function that can be used to build
a BlazeElementKernel:</p>
<dl class="docutils">
<dt>def add(a,b):</dt>
<dd>return a + b</dd>
</dl>
<p>Using Numba or another Python to LLVM tool, this can be converted into the following LLVM function for the float64 data:</p>
<p>define double &#64;add(double %a, double %b) nounwind readnone alwaysinline {
entry:</p>
<blockquote>
<div>%0 = fadd double %a, %b
ret double %0</div></blockquote>
<p>}</p>
</div>
<div class="section" id="kerneltrees">
<h2>KernelTrees<a class="headerlink" href="#kerneltrees" title="Permalink to this headline">¶</a></h2>
<p>Evaluating BlazeFunctions create KernelTrees which are tree structures
of BlazeElementKernels.  These tree structures are used to manage the
stitching together and &#8220;lifting&#8221; of the Element kernels at run-time</p>
</div>
<div class="section" id="lifting">
<h2>Lifting<a class="headerlink" href="#lifting" title="Permalink to this headline">¶</a></h2>
<p>The concept of lifting is that a BlazeElementKernel is transformed, or
lifted, to become a kernel accepting array arguments with a
larger number of dimensions.</p>
</div>
<div class="section" id="broadcasting">
<h2>Broadcasting<a class="headerlink" href="#broadcasting" title="Permalink to this headline">¶</a></h2>
<p>When multiple arguments are involved in a calculation, their shapes must
either be the same, or broadcastable to the same shape.</p>
</div>
</div>


      </div>
  </div>
</div>
  </body>
</html>